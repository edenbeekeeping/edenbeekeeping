<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Beekeeping Manager</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#ffd700" />
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("serviceWorker.js");
    }
  </script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5dc; }
    h1, h2 { color: #4b3f1d; }
    #menu button { margin: 5px; padding: 10px; }
    table { border-collapse: collapse; margin-top: 10px; width: 100%; }
    table, th, td { border: 1px solid #aaa; }
    th, td { padding: 5px; text-align: left; }
    input { margin: 5px 0; padding: 6px; width: 80%; max-width: 400px; display: block; }
    .product-card { border: 1px solid #ccc; padding: 10px; margin: 10px; display: inline-block; text-align: center; width: 150px; background: white; }
    .product-card img { width: 100px; height: 100px; object-fit: cover; }
    .section { display: none; }
  </style>
</head>
<body>
  <h1>üêù Beekeeping Management</h1>
  <div id="menu">
    <button onclick="showSection('dashboard')">üìä Dashboard</button>
    <button onclick="showSection('harvest')">Honey Harvests</button>
    <button onclick="showSection('sales')">Honey Sales</button>
    <button onclick="showSection('inspection')">Hive Inspections</button>
    <button onclick="showSection('inventory')">Inventory</button>
    <button onclick="showSection('tasks')">Tasks</button>
    <button onclick="showSection('catalog')">üì∑ Product Catalog</button>
    <button onclick="generateDocument('invoice')">üßæ New Invoice</button>
    <button onclick="generateDocument('quote')">üìÑ New Quotation</button>
  </div>

  <!-- Dashboard -->
  <div class="section" id="dashboard">
    <h2>üìä Dashboard</h2>
    <div id="dashboardSales"></div>
    <div id="dashboardHarvest"></div>
    <div id="dashboardInspections"></div>
  </div>

  <!-- Harvest -->
  <div class="section" id="harvest">
    <h2>Honey Harvests</h2>
    <table id="harvestTable"><thead><tr><th>Date</th><th>Hive</th><th>Location</th><th>Weight (kg)</th><th>Notes</th></tr></thead><tbody></tbody></table>
    <h3>Add Harvest</h3>
    <input id="harvestHive" placeholder="Hive ID" />
    <input id="harvestLocation" placeholder="Location" />
    <input id="harvestWeight" type="number" placeholder="Weight (kg)" />
    <input id="harvestNotes" placeholder="Notes" />
    <button onclick="saveHarvest()">Save</button>
  </div>

  <!-- Sales -->
  <div class="section" id="sales">
    <h2>Honey Sales</h2>
    <table id="salesTable"><thead><tr><th>Date</th><th>Buyer</th><th>Product</th><th>Qty</th><th>Price</th><th>Total</th></tr></thead><tbody></tbody></table>
    <h3>Add Sale</h3>
    <input id="saleBuyer" placeholder="Buyer" />
    <input id="saleProduct" placeholder="Product" />
    <input id="saleQuantity" type="number" placeholder="Quantity" />
    <input id="salePrice" type="number" placeholder="Price per unit" />
    <button onclick="saveSale()">Save</button>
  </div>

  <!-- Inspections -->
  <div class="section" id="inspection">
    <h2>Hive Inspections</h2>
    <table id="inspectionTable"><thead><tr><th>Date</th><th>Hive</th><th>Condition</th><th>Queen</th><th>Disease</th><th>Notes</th></tr></thead><tbody></tbody></table>
    <h3>Add Inspection</h3>
    <input id="inspectHive" placeholder="Hive ID" />
    <input id="inspectCondition" placeholder="Condition" />
    <input id="inspectQueen" placeholder="Queen Present?" />
    <input id="inspectDisease" placeholder="Diseases" />
    <input id="inspectNotes" placeholder="Notes" />
    <button onclick="saveInspection()">Save</button>
  </div>

  <!-- Inventory -->
  <div class="section" id="inventory">
    <h2>Inventory</h2>
    <table id="inventoryTable"><thead><tr><th>Name</th><th>Quantity</th><th>Used</th><th>Remaining</th></tr></thead><tbody></tbody></table>
    <h3>Add Inventory</h3>
    <input id="itemName" placeholder="Item Name" />
    <input id="itemQuantity" type="number" placeholder="Quantity" />
    <input id="itemUsed" type="number" placeholder="Used (if any)" />
    <button onclick="saveInventory()">Save</button>
  </div>

  <!-- Tasks -->
  <div class="section" id="tasks">
    <h2>Tasks</h2>
    <table id="taskTable"><thead><tr><th>Date</th><th>Task</th></tr></thead><tbody></tbody></table>
    <h3>Add Task</h3>
    <input id="taskDate" type="date" />
    <input id="taskDesc" placeholder="Task Description" />
    <button onclick="saveTask()">Save</button>
  </div>

  <!-- Catalog -->
  <div class="section" id="catalog">
    <h2>Product Catalog</h2>
    <div id="catalogList"></div>
    <h3>Add/Update Product</h3>
    <input id="prodName" placeholder="Product Name" />
    <input id="prodCategory" placeholder="Category" />
    <input id="prodPrice" type="number" placeholder="Price (R/unit)" />
    <input id="prodImage" placeholder="Image filename (in images folder)" />
    <button onclick="manageCatalog()">Save Product</button>
  </div>

<script>
function showSection(id){
  document.querySelectorAll('.section').forEach(s=>s.style.display='none');
  document.getElementById(id).style.display='block';
  refreshTables();
  if(id==='catalog') showCatalog();
}

function saveData(key,data){
  let arr=JSON.parse(localStorage.getItem(key)||"[]");
  arr.push(data);
  localStorage.setItem(key,JSON.stringify(arr));
  refreshTables();
}

function saveHarvest(){
  saveData("harvests",{date:today(),hive:v("harvestHive"),location:v("harvestLocation"),weight:parseFloat(v("harvestWeight")),notes:v("harvestNotes")});
}

function saveSale(){
  let qty=parseFloat(v("saleQuantity")),price=parseFloat(v("salePrice"));
  saveData("sales",{date:today(),buyer:v("saleBuyer"),product:v("saleProduct"),quantity:qty,price:price,total:qty*price});
}

function saveInspection(){
  saveData("inspections",{date:today(),hive:v("inspectHive"),condition:v("inspectCondition"),queen:v("inspectQueen"),disease:v("inspectDisease"),notes:v("inspectNotes")});
}

function saveInventory(){
  saveData("inventory",{name:v("itemName"),quantity:parseInt(v("itemQuantity")),used:parseInt(v("itemUsed"))||0});
}

function saveTask(){
  saveData("tasks",{date:v("taskDate"),desc:v("taskDesc")});
}

function manageCatalog(){
  let name=v("prodName"),cat=v("prodCategory"),price=parseFloat(v("prodPrice")),image=v("prodImage");
  let catlog=JSON.parse(localStorage.getItem("productCatalog")||"[]");
  let ex=catlog.find(p=>p.name===name);
  if(ex){ex.category=cat;ex.price=price;ex.image=image;} else {catlog.push({name,category:cat,price,image});}
  localStorage.setItem("productCatalog",JSON.stringify(catlog));
  showCatalog();
}

function showCatalog(){
  let catlog=JSON.parse(localStorage.getItem("productCatalog")||"[]");
  let c=document.getElementById("catalogList"); c.innerHTML="";
  catlog.forEach(p=>{
    let div=document.createElement("div");
    div.className="product-card";
    div.innerHTML=`<img src="images/${p.image}"><div>${p.name}</div><div>R${p.price}</div><div>${p.category}</div>`;
    c.appendChild(div);
  });
}

function refreshTables(){
  fillTable("harvestTable",JSON.parse(localStorage.getItem("harvests")||"[]"),["date","hive","location","weight","notes"]);
  fillTable("salesTable",JSON.parse(localStorage.getItem("sales")||"[]"),["date","buyer","product","quantity","price","total"]);
  fillTable("inspectionTable",JSON.parse(localStorage.getItem("inspections")||"[]"),["date","hive","condition","queen","disease","notes"]);
  fillTable("inventoryTable",JSON.parse(localStorage.getItem("inventory")||"[]").map(i=>({...i,remaining:i.quantity-(i.used||0)})),["name","quantity","used","remaining"]);
  fillTable("taskTable",JSON.parse(localStorage.getItem("tasks")||"[]"),["date","desc"]);
}

function fillTable(id,arr,cols){
  let tbody=document.querySelector(`#${id} tbody`);
  tbody.innerHTML="";
  arr.forEach(row=>{
    let tr=document.createElement("tr");
    cols.forEach(c=>{let td=document.createElement("td"); td.innerText=row[c]??""; tr.appendChild(td);});
    tbody.appendChild(tr);
  });
}

function v(id){return document.getElementById(id).value.trim();}
function today(){return new Date().toISOString().split("T")[0];}
</script>
</body>
</html>>
